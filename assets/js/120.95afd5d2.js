(window.webpackJsonp=window.webpackJsonp||[]).push([[120],{496:function(t,s,a){"use strict";a.r(s);var n=a(8),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"zhui-zong-line-notify-de-yue-du-lu-kai-xin-lu"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#zhui-zong-line-notify-de-yue-du-lu-kai-xin-lu"}},[t._v("#")]),t._v(" è¿½è¹¤ LINE Notify çš„é–±è®€ç‡ (é–‹ä¿¡ç‡)")]),t._v(" "),a("p",[t._v("ç¹¼ä¸Šæ¬¡çš„æ–‡ç« æåˆ°å¦‚ä½•è¿½è¹¤ä½¿ç”¨è€…æ˜¯å¦çœ‹é LINE è¨Šæ¯ï¼Œé€™ç¯‡æ–‡ç« è¦ä¾†ç¤ºç¯„å¦‚ä½•åœ¨ LINE Notify ä¸­è¿½è¹¤ä½¿ç”¨è€…çš„é–±è®€ç‡ï¼ˆé–‹ä¿¡ç‡ï¼‰ï¼")]),t._v(" "),a("blockquote",[a("p",[t._v("å¦‚æœä½ é‚„æ²’æœ‰çœ‹éå‰å¹¾ç¯‡ç›¸é—œæ–‡ç« ï¼Œå»ºè­°ä½ å…ˆçœ‹éä¸€éï¼š")]),t._v(" "),a("ol",[a("li",[a("a",{attrs:{href:"https://taichunmin.idv.tw/blog/2020-04-28-lintbot-google-analytics.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("è®“èŠå¤©æ©Ÿå™¨äººä¹Ÿèƒ½çœ‹ Google Analytics (1)"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://taichunmin.idv.tw/blog/2020-06-17-linebot-google-analytics.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("è¿½è¹¤ä½¿ç”¨è€…æœ‰æ²’æœ‰çœ‹ LINE è¨Šæ¯ (é–‹ä¿¡ç‡)"),a("OutboundLink")],1)])])]),t._v(" "),a("h2",{attrs:{id:"zhun-bei-yi-zhang-tu-pian"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#zhun-bei-yi-zhang-tu-pian"}},[t._v("#")]),t._v(" æº–å‚™ä¸€å¼µåœ–ç‰‡")]),t._v(" "),a("p",[t._v("ç”±æ–¼åœ¨ LINE Notify ä¸­ï¼Œæ²’è¾¦æ³•åƒä¸Šæ¬¡çš„æ–‡ç« æŠŠåœ–ç‰‡ä»¥ 1x1 çš„æ–¹å¼éš±è—èµ·ä¾†ï¼Œæ‰€ä»¥éœ€è¦æº–å‚™ä¸€å¼µçœ‹èµ·ä¾†æ­£å¸¸çš„åœ–ç‰‡ï¼Œé¿å…ä½¿ç”¨è€…è¦ºå¾—å¾ˆå¥‡æ€ªï¼š")]),t._v(" "),a("img",{staticStyle:{width:"128px"},attrs:{src:"https://i.imgur.com/5KWq1al.png"}}),t._v(" "),a("blockquote",[a("p",[t._v("Icon made by "),a("a",{attrs:{href:"https://www.flaticon.com/authors/kiranshastry",target:"_blank",rel:"noopener noreferrer"}},[a("strong",[t._v("Kiranshastry")]),a("OutboundLink")],1),t._v(" from "),a("a",{attrs:{href:"https://www.flaticon.com",target:"_blank",rel:"noopener noreferrer"}},[a("strong",[t._v("www.flaticon.com")]),a("OutboundLink")],1)])]),t._v(" "),a("h2",{attrs:{id:"tou-guo-hou-duan-chuan-song-google-analytics"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tou-guo-hou-duan-chuan-song-google-analytics"}},[t._v("#")]),t._v(" é€éå¾Œç«¯å‚³é€ Google Analytics")]),t._v(" "),a("p",[t._v("æ¥ä¸‹ä¾†æˆ‘å€‘è¦å¯«ä¸€å€‹å¾Œç«¯çš„ç¨‹å¼ï¼Œç•¶ä½¿ç”¨è€…çš„è£ç½®æ‰“é–‹ LINE Notify çš„èŠå¤©è¦–çª—æ™‚å°±æœƒåŸ·è¡Œå¾Œç«¯çš„ç¨‹å¼ï¼Œæˆ‘å€‘å¯ä»¥è®“ä½¿ç”¨è€…è·³è½‰åˆ°æˆ‘å€‘äº‹å…ˆæº–å‚™å¥½çš„åœ–ç‰‡ç¶²å€ï¼Œä¸¦ä¸”å·å·çš„æŠŠä½¿ç”¨è€…çš„ç€è¦½ç´€éŒ„å‚³é€çµ¦ Google Analyticsã€‚")]),t._v(" "),a("p",[t._v("åœ¨æ­¤æˆ‘é¸æ“‡ä½¿ç”¨ Google Cloud Function ä¾†å®Œæˆé€™å€‹å¾Œç«¯ï¼Œä»¥ä¸‹æ˜¯ç¯„ä¾‹ "),a("code",[t._v("Node.js")]),t._v(" ç¨‹å¼ç¢¼ï¼š")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("index.js")])])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" axios "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'axios'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" Qs "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'qs'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PAYLOAD_DEFAULT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  aip"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¿½ç•¥è¿½è¹¤ç™¼é€è€… IP")]),t._v("\n  an"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'My App'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// App Name")]),t._v("\n  av"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1.0.0'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// App ç‰ˆè™Ÿ")]),t._v("\n  de"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'UTF-8'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å­—å…ƒç·¨ç¢¼")]),t._v("\n  ds"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'app'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è³‡æ–™ä¾†æºï¼Œå¡«å¯«ç‚º app")]),t._v("\n  tid"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'UA-xxxxxxxxx-1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// GA è¿½è¹¤ä»£ç¢¼")]),t._v("\n  ul"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'zh-tw'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// locale")]),t._v("\n  v"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// api version")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("httpBuildQuery")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("obj")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" Qs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("stringify")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" arrayFormat"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'brackets'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("transformLineId")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("lineId")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  uid"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" lineId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  cid"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" lineId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token regex"}},[t._v("/^U(\\w{8})(\\w{4})(\\w{4})(\\w{4})(\\w{12})$/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'$1-$2-$3-$4-$5'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("gaScreenView")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("lineId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" overrides "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("lineId "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" axios"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("post")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://www.google-analytics.com/collect'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("httpBuildQuery")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PAYLOAD_DEFAULT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("overrides"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("transformLineId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("lineId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    t"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'screenview'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    cd"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nexports"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("main")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Cache-Control'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'public, max-age=31536000, s-maxage=31536000'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("redirect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("301")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://i.imgur.com/5KWq1al.png'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("gaScreenView")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("query"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("line_id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("query"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("blockquote",[a("p",[a("a",{attrs:{href:"https://developers.google.com/analytics/devguides/collection/protocol/v1",target:"_blank",rel:"noopener noreferrer"}},[t._v("é»æ­¤å¯æŸ¥çœ‹ Google Analytics Measurement Protocol çš„æ–‡ä»¶"),a("OutboundLink")],1)])]),t._v(" "),a("ul",[a("li",[a("code",[t._v("package.json")])])]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sample-http"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"version"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0.0.1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"dependencies"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"axios"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"^0.19.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"qs"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"^6.9.4"')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("blockquote",[a("p",[t._v("å¦‚æœé‚„ä¸æœƒå»ºç«‹ Cloud Function å¯ä»¥çœ‹ "),a("a",{attrs:{href:"https://taichunmin.idv.tw/blog/2020-04-06-line-devbot.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("ğŸ‘‰é€™ç¯‡æ–‡ç« "),a("OutboundLink")],1)])]),t._v(" "),a("p",[t._v("å¦‚æœä½ æƒ³è¦è‡ªå·±å¯«å¾Œç«¯ä¾†å¯¦åšé€™å€‹ç¨‹å¼çš„è©±ï¼Œéœ€è¦ç‰¹åˆ¥æ³¨æ„çš„åœ°æ–¹æœ‰å¹¾å€‹ï¼š")]),t._v(" "),a("ol",[a("li",[t._v("ä½¿ç”¨ HTTP 301 è·³è½‰åˆ°åœ–åºŠä¾†é¿å…å¾ Cloud Function ç›´æ¥é€å‡ºåœ–ç‰‡ï¼Œé€ æˆå·¨å¤§çš„ç¶²è·¯æµé‡è²»ç”¨ã€‚")]),t._v(" "),a("li",[t._v("åŠ ä¸Š "),a("code",[t._v("Cache-Control: public, max-age=31536000, s-maxage=31536000")]),t._v(" çš„ header ä¾†é¿å…ä½¿ç”¨è€…çš„è£ç½®é‡è¤‡è®€å–åœ–ç‰‡ï¼Œé€ æˆç€è¦½æ¬¡æ•¸é‡è¤‡è¨ˆç®—çš„ç‹€æ³ï¼Œåœ¨æœ¬æ–‡ä¸­æˆ‘ç›´æ¥è¨­å®šå¿«å– 365 å¤©ã€‚(å¯¦æ¸¬å¦‚æœæ²’ä½¿ç”¨ "),a("code",[t._v("Cache-Control")]),t._v(" æœƒå°è‡´ç€è¦½æ•¸è¢«é‡è¤‡è¨ˆç®—è¶…é 10 å€ä»¥ä¸Š)")]),t._v(" "),a("li",[t._v("é€è³‡æ–™çµ¦ Google Analytics æ™‚ä¸€å®šè¦åŠ ä¸Š "),a("code",[t._v("aip")]),t._v(" é€™å€‹åƒæ•¸ï¼Œå› ç‚ºä½¿ç”¨è€…çš„ç€è¦½è³‡æ–™æ˜¯å¾Œç«¯ç¨‹å¼ä»£æ›¿é€å‡ºçš„ï¼Œæ‰€ä»¥å¾Œç«¯ç¨‹å¼çš„ IP æ²’æœ‰æ„ç¾©ã€‚")]),t._v(" "),a("li",[t._v("è«‹è¨˜å¾—å°‡ "),a("code",[t._v("tid")]),t._v(" æ›æˆè‡ªå·±çš„ Google Analytics çš„ IDã€‚")])]),t._v(" "),a("h2",{attrs:{id:"tui-song-line-notify-gei-shi-yong-zhe"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tui-song-line-notify-gei-shi-yong-zhe"}},[t._v("#")]),t._v(" æ¨é€ LINE Notify çµ¦ä½¿ç”¨è€…")]),t._v(" "),a("p",[t._v("æœ€å¾Œæˆ‘å€‘å°±å¯ä»¥é€é LINE Notify API ä¾†é€å‡ºè¨Šæ¯çµ¦ä½¿ç”¨è€…ï¼Œåœ¨æ­¤ä»¥ "),a("code",[t._v("node.js")]),t._v(" ä¾†åšç¤ºç¯„ï¼š")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" axios "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'axios'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" Qs "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'qs'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("httpBuildQuery")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("obj")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" Qs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("stringify")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" arrayFormat"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'brackets'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("photoScreenView")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("lineId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("https://example.cloudfunctions.net/linebot-notify-ga-demo-20200629?")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("httpBuildQuery")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    line_id"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" lineId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    z"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Date")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sendLineNotify")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("token"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" message"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ga")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" axios"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("post")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://cors-anywhere.herokuapp.com/https://notify-api.line.me/api/notify'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("httpBuildQuery")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    message"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    imageThumbnail"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" ga"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    imageFullsize"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://i.imgur.com/5KWq1al.png'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n    headers"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" Authorization"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("Bearer ")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("token"),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sendLineNotify")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'line-notify-access-token'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'æ¸¬è©¦ Google Analytics è¿½è¹¤'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("photoScreenView")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'line-user-id'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'å·²é–±è®€ LINE Notify'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("å¦‚æœä½ æƒ³è¦ç”¨è‡ªå·±çš„ç¨‹å¼ç¢¼ä¾†å¯¦åšé€™å€‹éƒ¨ä»½ï¼Œä½ éœ€è¦æ³¨æ„çš„åœ°æ–¹æœ‰ï¼š")]),t._v(" "),a("ol",[a("li",[t._v("åœ¨ç¶²å€ä¸­éœ€è¦æŠŠä¸­æ–‡å­—åŠç‰¹æ®Šç¬¦è™Ÿæ­£ç¢ºçš„åš "),a("code",[t._v("urlencode")])]),t._v(" "),a("li",[t._v("åœ¨ç”¢ç”Ÿåœ–ç‰‡é è¦½ç¶²å€ "),a("code",[t._v("imageThumbnail")]),t._v(" æ™‚ï¼Œé ˆåŠ ä¸Šç¾åœ¨çš„æ™‚é–“æˆ³è¨˜ä¾†ç¢ºä¿åœ–ç‰‡è‡³å°‘é‡æ–°ä¸‹è¼‰ä¸€æ¬¡")]),t._v(" "),a("li",[t._v("éœ€è¦å…ˆå–å¾—ä½¿ç”¨è€…æˆæ¬Šçš„ LINE Notify Access Tokenï¼Œæœ¬æ–‡ä¸­ç›´æ¥ç”¨ç™¼è¡Œå­˜å–æ¬Šæ–ï¼ˆé–‹ç™¼äººå“¡ç”¨ï¼‰ä¾†åšç¤ºç¯„")])]),t._v(" "),a("p",[t._v("ç•¶ä½ æˆåŠŸé€å‡º LINE Notify ä»¥å¾Œï¼Œåœ¨æ‰‹æ©Ÿä¸Šé¢çœ‹èµ·ä¾†æœƒåƒæ˜¯é€™æ¨£ï¼š")]),t._v(" "),a("img",{staticStyle:{width:"480px"},attrs:{src:"https://i.imgur.com/n1iBsuP.jpg"}}),t._v(" "),a("h2",{attrs:{id:"yuan-shi-ma-ji-can-kao-lian-jie"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#yuan-shi-ma-ji-can-kao-lian-jie"}},[t._v("#")]),t._v(" åŸå§‹ç¢¼åŠåƒè€ƒé€£çµ")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("p",[t._v("æœ¬æ–‡ç¯„ä¾‹ç¨‹å¼çš„åŸå§‹ç¢¼æˆæ¬Šç‚º MIT Licenseã€‚")])]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://www.oxxostudio.tw/articles/201706/google-analytics-tracking-email.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Google Analytics è¿½è¹¤ Email èˆ‡é»æ“Šæˆæ•ˆ"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://engineering.linecorp.com/zh-hant/blog/line-developer-meetup-12/",target:"_blank",rel:"noopener noreferrer"}},[t._v("LINE Developer Meetup #12 é–‹ç™¼è€…å°èšæ´»å‹•å¾Œåˆ†äº«"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=e.exports}}]);